---
- name: Packages
  hosts: workstations
  become: yes
  tasks:
    - name: Upgrade all packages
      yum:
        name: '*'
        state: latest
    - name: Ensure basic packages
      package:
        name: '{{item}}'
        state: latest
      loop:
          - git
          - htop
          - NetworkManager-openvpn
          - NetworkManager-openvpn-gnome
          - p7zip
          - unzip
          - wget
          - gnome-tweaks
          - terminator
          - transmission
          - libreoffice-base
    - name: Add Sublime repository
      yum_repository:
        name: sublime-text
        description: Sublime Text x86_64 - stable
        baseurl: https://download.sublimetext.com/rpm/stable/x86_64
        enabled: yes
        gpgcheck: yes
        gpgkey: https://download.sublimetext.com/sublimehq-rpm-pub.gpg
    - name: Add Google chrome Repository
      yum_repository:
        name: google-chrome-stable
        description: Google Chrome Stable x86_64 - stable
        baseurl: https://dl.google.com/linux/chrome/rpm/stable/x86_64
        enabled: yes
        gpgcheck: yes
        gpgkey: https://dl.google.com/linux/linux_signing_key.pub
    - name: Add KeeWeb Repository
      yum_repository:
        name: KeeWeb
        description: KeeWeb x86_64
        baseurl: https://download.copr.fedorainfracloud.org/results/jclay/KeeWeb/epel-8-x86_64
        enabled: yes
        gpgcheck: yes
        gpgkey: https://download.copr.fedorainfracloud.org/results/jclay/KeeWeb/pubkey.gpg
    - name: Add AnyDesk Repository
      yum_repository:
        name: AnyDesk
        description: AnyDesk x86_64
        baseurl: http://rpm.anydesk.com/rhel/8/x86_64
        enabled: yes
        gpgcheck: yes
        gpgkey: https://keys.anydesk.com/repos/RPM-GPG-KEY
    - name: Add Extra packages
      package:
        name: '{{item}}'
        state: present
      loop:
        - sublime-text
        - google-chrome-stable
        - KeeWeb
        - anydesk
    - name: Get Jetbrains Toolbox Installer
      get_url:
        url: https://raw.githubusercontent.com/nagygergo/jetbrains-toolbox-install/master/jetbrains-toolbox.sh
        dest: /tmp/jetbrains-toolbox.sh
    - name: Install Jenbrains Toolbox
      ansible.builtin.shell: 'sh /tmp/jetbrains-toolbox.sh'
      args:
        creates: /usr/local/bin/jetbrains-toolbox
